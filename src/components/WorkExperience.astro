---
import { experience } from '../../content.json';

// Helper function to format dates
function formatDate(dateString: string): string {
  const [year, month] = dateString.split('-');
  const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
  return `${monthNames[parseInt(month) - 1]} ${year}`;
}
---

<section id='exp' class='py-24 md:py-32 bg-base-100'>
  <div class='container mx-auto px-4 sm:px-6 lg:px-8'>
    <!-- Section Header -->
    <header class='max-w-3xl mb-16 md:mb-24'>
      <p class='text-sm font-semibold uppercase tracking-wider text-base-content/70 mb-4'>
        Experience
      </p>
      <h2 class='text-4xl md:text-5xl font-bold tracking-tight mb-8 text-base-content'>
        Work History
      </h2>
      <p class='text-lg text-base-content/80'>
        These are some of the companies I have worked for in the past.
      </p>
    </header>

    <!-- Timeline Container -->
    <div class='relative flex justify-center max-w-5xl mx-auto'>
      <!-- Timeline Line - Hidden on mobile -->
      <div class='absolute left-6 top-0 bottom-0 w-px bg-gradient-to-b from-primary/60 via-primary/40 to-primary/20 hidden sm:block'></div>
      
      <!-- Experience Items -->
      <div class='space-y-8 sm:space-y-12'>
        {experience.map((job) => {
          const startDate = formatDate(job.start);
          const endDate = formatDate(job.end);
          
          return (
            <article class='relative'>
              {/* To date above card - Hidden on mobile */}
              <div class='pl-16 pb-6 hidden sm:block'>
                <div class='absolute left-6 transform -translate-x-1/2'>
                  <div class='w-3 h-3 rounded-full bg-primary shadow-lg border-2 border-base-100 z-20'></div>
                  <div class='absolute left-6 -top-1 text-xs font-medium text-base-content/70 whitespace-nowrap'>
                    to {endDate}
                  </div>
                </div>
              </div>

              {/* Job Card */}
              <div class='pl-0 sm:pl-16'>
                <div class='bg-base-200/50 backdrop-blur-sm rounded-xl p-4 sm:p-6 md:p-8 shadow-sm hover:shadow-lg transition-all duration-300 group border border-base-content/5'>
                  <!-- Mobile date display -->
                  <div class='sm:hidden mb-4 text-center'>
                    <span class='text-sm font-medium text-base-content/70 bg-primary/10 px-3 py-1 rounded-full'>
                      {startDate} - {endDate}
                    </span>
                  </div>
                  
                  <div class='flex flex-col md:flex-row lg:flex-row gap-4 sm:gap-6'>
                    <!-- Company Info -->
                    <div class='md:w-1/3 lg:w-1/3 flex flex-col text-center md:text-left'>
                      <div class='mb-4 flex justify-center md:justify-start'>
                        <img
                          src={job.image}
                          alt={`${job.company} logo`}
                          class='h-10 sm:h-12 md:h-16 w-auto object-contain transition-transform duration-300 group-hover:scale-105'
                          loading='lazy'
                        />
                      </div>
                      <div class='space-y-2'>
                        <h3 class='text-base sm:text-lg md:text-xl font-bold text-base-content group-hover:text-primary transition-colors'>
                          {job.company}
                        </h3>
                        <p class='text-xs sm:text-sm text-base-content/60 flex items-center justify-center md:justify-start gap-1'>
                          <svg class='w-3 h-3' fill='currentColor' viewBox='0 0 20 20'>
                            <path fill-rule='evenodd' d='M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z' clip-rule='evenodd'></path>
                          </svg>
                          {job.location}
                        </p>
                      </div>
                    </div>
                    
                    <!-- Job Details -->
                    <div class='md:w-2/3 lg:w-2/3 text-center md:text-left'>
                      <h4 class='text-sm sm:text-base md:text-lg font-semibold text-base-content/90 mb-3'>
                        {job.role}
                      </h4>
                      <p class='text-sm sm:text-base text-base-content/80 mb-4 leading-relaxed text-left'>
                        {job.description}
                      </p>
                      <ul class='space-y-2 text-left'>
                        {job.responsibilities.map((responsibility) => (
                          <li class='flex items-start gap-3 text-xs sm:text-sm text-base-content/70'>
                            <span class='w-1.5 h-1.5 rounded-full bg-primary mt-2 flex-shrink-0'></span>
                            <span>{responsibility}</span>
                          </li>
                        ))}
                      </ul>
                    </div>
                  </div>
                </div>
              </div>

              {/* From date below card - Hidden on mobile */}
              <div class='pl-16 pt-6 hidden sm:block'>
                <div class='absolute left-6 transform -translate-x-1/2'>
                  <div class='w-3 h-3 rounded-full bg-primary shadow-lg border-2 border-base-100 z-20'></div>
                  <div class='absolute left-6 -top-1 text-xs font-medium text-base-content/70 whitespace-nowrap'>
                    from {startDate}
                  </div>
                </div>
              </div>
            </article>
          );
        })}
      </div>
    </div>
  </div>
</section>
