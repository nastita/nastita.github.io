---
const menuItems = [
  { name: 'Main', href: '#main' },
  { name: 'Exp', href: '#exp' },
  { name: 'Skills', href: '#skills' },
  { name: 'Kudos', href: '#kudos' },
];

// Update these URLs with your actual ones
const githubUrl = 'https://github.com/nastita';
const linkedinUrl = 'https://linkedin.com/in/nastita';
const portfolioPath = '/resume-sacco.pdf';
---

<!-- Top progress bar -->
<div
  class='fixed top-0 left-0 w-full h-1 bg-transparent z-[200] pointer-events-none'
>
  <div
    id='progress-bar'
    class='h-full bg-primary transition-all duration-100 ease-out'
    style='width: 0%;'
  >
  </div>
</div>

<header
  id='header'
  class='fixed top-0 left-0 w-full z-[100] flex justify-center pointer-events-none'
>
  <nav
    id='nav-menu'
    class='bg-base-200 rounded-2xl shadow-lg flex flex-row justify-center items-center gap-4 px-6 py-4 nav-responsive pointer-events-auto min-w-fit'
    style='margin-top:1.2rem;'
  >
    <div class='flex flex-row gap-4'>
      {
        menuItems.map((item, idx) => (
          <a
            href={item.href}
            class={`menu-item text-base uppercase nav-link hover:text-primary text-neutral-content relative hover:scale-105 transition-transform duration-200`}
            data-menu-index={idx}
          >
            {item.name}
          </a>
        ))
      }
    </div>
    <div
      class='flex items-center gap-4 ml-4 border-l border-base-content/20 pl-4 nav-icons'
    >
      <a
        href={githubUrl}
        target='_blank'
        rel='noopener noreferrer'
        class='text-white hover:text-primary transition-all duration-200 hover:scale-105 tooltip tooltip-bottom tooltip-primary'
        aria-label='GitHub Profile'
        data-tip='GitHub Profile'
      >
        <img
          src='/icons/github.svg'
          alt='GitHub'
          class='h-6 w-6 flex-shrink-0 brightness-0 invert'
        />
      </a>
      <a
        href={linkedinUrl}
        target='_blank'
        rel='noopener noreferrer'
        class='text-white hover:text-primary transition-all duration-200 hover:scale-105 tooltip tooltip-bottom tooltip-primary'
        aria-label='LinkedIn Profile'
        data-tip='LinkedIn Profile'
      >
        <img
          src='/icons/linkedin.svg'
          alt='LinkedIn'
          class='h-6 w-6 flex-shrink-0 brightness-0 invert'
        />
      </a>
      <a
        href={portfolioPath}
        class='text-white hover:text-primary transition-all duration-200 hover:scale-105 tooltip tooltip-bottom tooltip-primary'
        aria-label='Download Resume'
        data-tip='Download Resume'
        download
      >
        <img
          src='/icons/resume.svg'
          alt='Resume'
          class='h-6 w-6 flex-shrink-0 brightness-0 invert'
        />
      </a>
    </div>
  </nav>
</header>

<script>
  import gsap from 'gsap';
  import { ScrollTrigger } from 'gsap/ScrollTrigger';

  gsap.registerPlugin(ScrollTrigger);

  // Progress bar scroll indicator
  const sectionIds = ['main', 'exp', 'skills', 'kudos'];
  const navLinks = document.querySelectorAll('.nav-link');
  const progressBar = document.getElementById('progress-bar');

  if (progressBar) {
    // Create ScrollTrigger for overall page progress
    ScrollTrigger.create({
      trigger: 'body',
      start: 'top top',
      end: 'bottom bottom',
      onUpdate: (self) => {
        // Calculate overall scroll progress (0 to 1)
        const scrollProgress = self.progress;

        // Update progress bar width
        gsap.set(progressBar, {
          width: `${scrollProgress * 100}%`,
        });

        // Also determine current active section for menu highlighting
        let currentSection = 0;

        for (let i = 0; i < sectionIds.length; i++) {
          const section = document.getElementById(sectionIds[i]);
          if (section) {
            const rect = section.getBoundingClientRect();
            // Section is active if it's prominently in the viewport (top portion)
            if (rect.top <= 200 && rect.bottom > 200) {
              currentSection = i;
              break;
            }
          }
        }

        // Update active link states
        navLinks.forEach((link, idx) => {
          if (idx === currentSection) {
            link.classList.add('active');
          } else {
            link.classList.remove('active');
          }
        });
      },
    });
  }
</script>
